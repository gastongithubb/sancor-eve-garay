---
import { google } from 'googleapis';
import { response, type Request } from 'express';

const oauth2Client = new google.auth.OAuth2(
  import.meta.env.GOOGLE_CLIENT_ID,
  import.meta.env.GOOGLE_CLIENT_SECRET,
  `http://localhost:${import.meta.env.PORT}/auth/google/callback`
);

export async function handleRequest({ request }: { request: Request }) {
  const authUrl = oauth2Client.generateAuthUrl({
    access_type: 'offline',
    scope: ['profile', 'email'],
  });

  response.redirect(authUrl);
}
---