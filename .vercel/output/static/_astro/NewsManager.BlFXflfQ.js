import{j as e}from"./jsx-runtime.CYYqVSlZ.js";import{r as s}from"./index.DJO9vBfz.js";import{c as S,d as q,s as L,i as T,t as g,a as N,b as v}from"./config.C_G0umPK.js";const A=S({url:N.tursoConnectionUrl,authToken:N.tursoAuthToken}),b=q(A),h=L("news",{id:T("id").primaryKey(),url:g("url").notNull(),title:g("title").notNull(),publishDate:g("publish_date").notNull()});async function P(){try{return await b.select().from(h).all()}catch(n){throw console.error("Error al obtener noticias:",n),n}}async function G(n){try{await b.insert(h).values(n).run()}catch(o){throw console.error("Error al añadir noticia:",o),o}}async function I(n){try{await b.delete(h).where(v`id = ${n}`).run()}catch(o){throw console.error("Error al eliminar noticia:",o),o}}async function U(n,o){try{await b.update(h).set(o).where(v`id = ${n}`).run()}catch(d){throw console.error("Error al actualizar noticia:",d),d}}const M=()=>{const[n,o]=s.useState([]),[d,j]=s.useState([]),[p,y]=s.useState(""),[l,u]=s.useState({url:"",title:"",publishDate:""}),[a,i]=s.useState(null),[x,c]=s.useState(null),[k,f]=s.useState(!0);s.useEffect(()=>{m()},[]),s.useEffect(()=>{const r=n.filter(t=>t.title.toLowerCase().includes(p.toLowerCase()));j(r)},[p,n]);const m=async()=>{f(!0);try{const r=await P();o(r)}catch(r){console.error("Error fetching news:",r),c("Error al cargar las noticias. Por favor, intenta de nuevo.")}finally{f(!1)}},w=r=>!r.url.trim()||!r.title.trim()||!r.publishDate.trim()?(c("Todos los campos son obligatorios."),!1):(c(null),!0),z=async r=>{if(r.preventDefault(),!!w(l))try{await G(l),m(),u({url:"",title:"",publishDate:""})}catch(t){console.error("Error adding news:",t),c("Error al añadir la noticia. Por favor, intenta de nuevo.")}},E=async r=>{try{await I(r),m()}catch(t){console.error("Error deleting news:",t),c("Error al eliminar la noticia. Por favor, intenta de nuevo.")}},C=async r=>{if(r.preventDefault(),a&&w(a))try{await U(a.id,a),m(),i(null)}catch(t){console.error("Error updating news:",t),c("Error al actualizar la noticia. Por favor, intenta de nuevo.")}},D=()=>e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((r,t)=>e.jsxs("div",{className:"p-4 bg-white border rounded-lg shadow-card border-zinc-300",children:[e.jsx("div",{className:"w-3/4 h-6 mb-2 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"w-full h-5 mb-2 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"w-1/3 h-5 mb-4 bg-gray-200 rounded animate-pulse"}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-20 mr-2 bg-gray-200 rounded h-9 animate-pulse"}),e.jsx("div",{className:"w-20 bg-gray-200 rounded h-9 animate-pulse"})]})]},t))});return e.jsxs("div",{className:"container p-4 mx-auto font-SpaceGrotesk",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-black",children:"Gestor de Noticias"}),e.jsxs("div",{className:"relative w-64",children:[e.jsx("input",{type:"text",placeholder:"Buscar por título",value:p,onChange:r=>y(r.target.value),className:"w-full p-2 pl-10 pr-4 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime"}),e.jsx("svg",{className:"absolute w-5 h-5 transform -translate-y-1/2 left-3 top-1/2 text-zinc-400",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),x&&e.jsx("div",{className:"p-2 mb-4 text-red-700 bg-red-100 rounded-lg",children:x}),e.jsxs("form",{onSubmit:z,className:"mb-4",children:[e.jsx("input",{type:"text",placeholder:"URL",value:l.url,onChange:r=>u({...l,url:r.target.value}),className:"p-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),e.jsx("input",{type:"text",placeholder:"Título",value:l.title,onChange:r=>u({...l,title:r.target.value}),className:"p-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),e.jsx("input",{type:"date",value:l.publishDate,onChange:r=>u({...l,publishDate:r.target.value}),className:"p-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),e.jsx("button",{type:"submit",className:"p-2 text-white transition duration-300 bg-black rounded-lg hover:bg-lime",children:"Añadir Noticia"})]}),k?D():e.jsx("div",{className:"space-y-4",children:d.map(r=>e.jsx("div",{className:"p-4 bg-white border rounded-lg shadow-card border-zinc-300",children:a&&a.id===r.id?e.jsxs("form",{onSubmit:C,children:[e.jsx("input",{type:"text",value:a.url,onChange:t=>i({...a,url:t.target.value}),className:"p-2 mb-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),e.jsx("input",{type:"text",value:a.title,onChange:t=>i({...a,title:t.target.value}),className:"p-2 mb-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),e.jsx("input",{type:"date",value:a.publishDate,onChange:t=>i({...a,publishDate:t.target.value}),className:"p-2 mb-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),e.jsx("button",{type:"submit",className:"p-2 mr-2 text-white transition duration-300 bg-black rounded-lg hover:bg-lime",children:"Guardar"}),e.jsx("button",{onClick:()=>i(null),className:"p-2 text-black transition duration-300 rounded-lg bg-zinc-200 hover:bg-zinc-300",children:"Cancelar"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mb-2 text-xl font-bold text-black",children:r.title}),e.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"mb-2 transition duration-300 text-lime hover:text-black",children:r.url}),e.jsx("p",{className:"mb-4 text-zinc-500",children:r.publishDate}),e.jsx("button",{onClick:()=>i(r),className:"p-2 mr-2 text-black transition duration-300 rounded-lg bg-zinc-200 hover:bg-zinc-300",children:"Editar"}),e.jsx("button",{onClick:()=>E(r.id),className:"p-2 text-white transition duration-300 bg-black rounded-lg hover:bg-lime",children:"Eliminar"})]})},r.id))})]})};export{M as default};
