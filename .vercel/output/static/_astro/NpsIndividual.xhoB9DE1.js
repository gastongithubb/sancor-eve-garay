import{j as l}from"./jsx-runtime.CYYqVSlZ.js";import{R as v,r as E}from"./index.DJO9vBfz.js";import{L as q,c as J,d as Q}from"./loader-circle.DDk-CQ-d.js";import{u as Z,a as tt,b as et,i as p,c as rt,d as it,e as G,w as _,g as H,f as K,h as M,C as U,j as at,k as nt,B as k,X as V,Y as R,l as lt,R as ot,T as st,L as ct,m as F}from"./generateCategoricalChart.BsJQYdF2.js";import"./config.Dew_jzzj.js";var ht=["x1","y1","x2","y2","key"],dt=["offset"];function w(t){"@babel/helpers - typeof";return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(t)}function D(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,r)}return a}function y(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?D(Object(a),!0).forEach(function(r){ut(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function ut(t,e,a){return e=ft(e),e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function ft(t){var e=xt(t,"string");return w(e)=="symbol"?e:String(e)}function xt(t,e){if(w(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,e||"default");if(w(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j(){return j=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},j.apply(this,arguments)}function W(t,e){if(t==null)return{};var a=vt(t,e),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vt(t,e){if(t==null)return{};var a={},r=Object.keys(t),n,o;for(o=0;o<r.length;o++)n=r[o],!(e.indexOf(n)>=0)&&(a[n]=t[n]);return a}var yt=function(e){var a=e.fill;if(!a||a==="none")return null;var r=e.fillOpacity,n=e.x,o=e.y,h=e.width,f=e.height;return v.createElement("rect",{x:n,y:o,width:h,height:f,stroke:"none",fill:a,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function X(t,e){var a;if(v.isValidElement(t))a=v.cloneElement(t,e);else if(G(t))a=t(e);else{var r=e.x1,n=e.y1,o=e.x2,h=e.y2,f=e.key,x=W(e,ht),u=at(x,!1);u.offset;var s=W(u,dt);a=v.createElement("line",j({},s,{x1:r,y1:n,x2:o,y2:h,fill:"none",key:f}))}return a}function mt(t){var e=t.x,a=t.width,r=t.horizontal,n=r===void 0?!0:r,o=t.horizontalPoints;if(!n||!o||!o.length)return null;var h=o.map(function(f,x){var u=y(y({},t),{},{x1:e,y1:f,x2:e+a,y2:f,key:"line-".concat(x),index:x});return X(n,u)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function gt(t){var e=t.y,a=t.height,r=t.vertical,n=r===void 0?!0:r,o=t.verticalPoints;if(!n||!o||!o.length)return null;var h=o.map(function(f,x){var u=y(y({},t),{},{x1:f,y1:e,x2:f,y2:e+a,key:"line-".concat(x),index:x});return X(n,u)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function bt(t){var e=t.horizontalFill,a=t.fillOpacity,r=t.x,n=t.y,o=t.width,h=t.height,f=t.horizontalPoints,x=t.horizontal,u=x===void 0?!0:x;if(!u||!e||!e.length)return null;var s=f.map(function(d){return Math.round(d+n-n)}).sort(function(d,i){return d-i});n!==s[0]&&s.unshift(0);var g=s.map(function(d,i){var c=!s[i+1],b=c?n+h-d:s[i+1]-d;if(b<=0)return null;var m=i%e.length;return v.createElement("rect",{key:"react-".concat(i),y:d,x:r,height:b,width:o,stroke:"none",fill:e[m],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},g)}function pt(t){var e=t.vertical,a=e===void 0?!0:e,r=t.verticalFill,n=t.fillOpacity,o=t.x,h=t.y,f=t.width,x=t.height,u=t.verticalPoints;if(!a||!r||!r.length)return null;var s=u.map(function(d){return Math.round(d+o-o)}).sort(function(d,i){return d-i});o!==s[0]&&s.unshift(0);var g=s.map(function(d,i){var c=!s[i+1],b=c?o+f-d:s[i+1]-d;if(b<=0)return null;var m=i%r.length;return v.createElement("rect",{key:"react-".concat(i),x:d,y:h,width:b,height:x,stroke:"none",fill:r[m],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},g)}var jt=function(e,a){var r=e.xAxis,n=e.width,o=e.height,h=e.offset;return H(K(y(y(y({},U.defaultProps),r),{},{ticks:M(r,!0),viewBox:{x:0,y:0,width:n,height:o}})),h.left,h.left+h.width,a)},wt=function(e,a){var r=e.yAxis,n=e.width,o=e.height,h=e.offset;return H(K(y(y(y({},U.defaultProps),r),{},{ticks:M(r,!0),viewBox:{x:0,y:0,width:n,height:o}})),h.top,h.top+h.height,a)},C={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Y(t){var e,a,r,n,o,h,f=Z(),x=tt(),u=et(),s=y(y({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:C.stroke,fill:(a=t.fill)!==null&&a!==void 0?a:C.fill,horizontal:(r=t.horizontal)!==null&&r!==void 0?r:C.horizontal,horizontalFill:(n=t.horizontalFill)!==null&&n!==void 0?n:C.horizontalFill,vertical:(o=t.vertical)!==null&&o!==void 0?o:C.vertical,verticalFill:(h=t.verticalFill)!==null&&h!==void 0?h:C.verticalFill,x:p(t.x)?t.x:u.left,y:p(t.y)?t.y:u.top,width:p(t.width)?t.width:u.width,height:p(t.height)?t.height:u.height}),g=s.x,d=s.y,i=s.width,c=s.height,b=s.syncWithTicks,m=s.horizontalValues,T=s.verticalValues,O=rt(),P=it();if(!p(i)||i<=0||!p(c)||c<=0||!p(g)||g!==+g||!p(d)||d!==+d)return null;var $=s.verticalCoordinatesGenerator||jt,B=s.horizontalCoordinatesGenerator||wt,z=s.horizontalPoints,A=s.verticalPoints;if((!z||!z.length)&&G(B)){var L=m&&m.length,S=B({yAxis:P?y(y({},P),{},{ticks:L?m:P.ticks}):void 0,width:f,height:x,offset:u},L?!0:b);_(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(w(S),"]")),Array.isArray(S)&&(z=S)}if((!A||!A.length)&&G($)){var I=T&&T.length,N=$({xAxis:O?y(y({},O),{},{ticks:I?T:O.ticks}):void 0,width:f,height:x,offset:u},I?!0:b);_(Array.isArray(N),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(w(N),"]")),Array.isArray(N)&&(A=N)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(yt,{fill:s.fill,fillOpacity:s.fillOpacity,x:s.x,y:s.y,width:s.width,height:s.height}),v.createElement(mt,j({},s,{offset:u,horizontalPoints:z,xAxis:O,yAxis:P})),v.createElement(gt,j({},s,{offset:u,verticalPoints:A,xAxis:O,yAxis:P})),v.createElement(bt,j({},s,{horizontalPoints:z})),v.createElement(pt,j({},s,{verticalPoints:A})))}Y.displayName="CartesianGrid";var Ct=nt({chartName:"BarChart",GraphicalChild:k,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:V},{axisType:"yAxis",AxisComp:R}],formatAxisMap:lt});const kt=()=>{const[t,e]=E.useState([]),[a,r]=E.useState(!0),[n,o]=E.useState(null),[h,f]=E.useState("");E.useEffect(()=>{(async()=>{try{r(!0);const c=await J();e(c),o(null)}catch(c){console.error("Error al cargar usuarios:",c),o(`Error al cargar las métricas: ${c instanceof Error?c.message:String(c)}`)}finally{r(!1)}})()},[]);const x=async i=>{try{await Q(i),e(t.map(c=>c.id===i.id?i:c))}catch(c){console.error("Error al actualizar el usuario:",c),o(`Error al actualizar el usuario: ${c instanceof Error?c.message:String(c)}`)}},u=(i,c,b)=>{e(t.map(m=>m.id===i?{...m,[c]:Number(b)}:m))},s=i=>i>=15?"#28a745":i>=0?"#ffc107":"#dc3545",g=i=>i>70?"#28a745":i>=65?"#ffc107":"#dc3545",d=t.filter(i=>i.name.toLowerCase().includes(h.toLowerCase()));return a?l.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[l.jsx(q,{className:"w-12 h-12 text-blue-500 animate-spin"}),l.jsx("p",{className:"mt-4 text-lg font-semibold text-gray-700",children:"Cargando programacion semanal."})]}):n?l.jsx("div",{className:"flex flex-col items-center justify-center h-screen",children:l.jsx("p",{className:"text-lg font-semibold text-red-600",children:n})}):t.length===0?l.jsx("div",{children:"No se encontraron datos de usuarios."}):l.jsxs("div",{children:[l.jsx("h1",{children:"Métricas - NPS Individual"}),l.jsx("input",{type:"text",placeholder:"Buscar por nombre...",value:h,onChange:i=>f(i.target.value),style:{marginBottom:"20px",padding:"5px",width:"200px"}}),l.jsx(ot,{width:"100%",height:500,children:l.jsxs(Ct,{data:d,margin:{top:20,right:30,left:20,bottom:5},children:[l.jsx(Y,{strokeDasharray:"3 3"}),l.jsx(V,{dataKey:"name"}),l.jsx(R,{}),l.jsx(st,{}),l.jsx(ct,{}),l.jsx(k,{dataKey:"responses",fill:"#8884d8",name:"Encuestas"}),l.jsx(k,{dataKey:"nps",name:"NPS",children:d.map(i=>l.jsx(F,{fill:s(i.nps)},`cell-nps-${i.id}`))}),l.jsx(k,{dataKey:"csat",name:"CSAT",children:d.map(i=>l.jsx(F,{fill:g(i.csat)},`cell-csat-${i.id}`))}),l.jsx(k,{dataKey:"rd",name:"RD",children:d.map(i=>l.jsx(F,{fill:g(i.rd)},`cell-rd-${i.id}`))})]})}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"20px"},children:d.map(i=>l.jsxs("div",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"8px",width:"300px"},children:[l.jsx("h2",{children:i.name}),l.jsx("div",{style:{marginBottom:"10px"},children:l.jsxs("label",{children:["Encuestas:",l.jsx("input",{type:"number",value:i.responses,onChange:c=>u(i.id,"responses",c.target.value),style:{width:"100%"}})]})}),l.jsx("div",{style:{marginBottom:"10px"},children:l.jsxs("label",{children:["NPS:",l.jsx("input",{type:"number",value:i.nps,onChange:c=>u(i.id,"nps",c.target.value),style:{width:"100%"}})]})}),l.jsx("div",{style:{marginBottom:"10px"},children:l.jsxs("label",{children:["CSAT:",l.jsx("input",{type:"number",value:i.csat,onChange:c=>u(i.id,"csat",c.target.value),style:{width:"100%"}})]})}),l.jsx("div",{style:{marginBottom:"10px"},children:l.jsxs("label",{children:["RD:",l.jsx("input",{type:"number",value:i.rd,onChange:c=>u(i.id,"rd",c.target.value),style:{width:"100%"}})]})}),l.jsx("button",{onClick:()=>x(i),style:{width:"100%",padding:"10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",transition:"background-color 0.3s"},onMouseOver:c=>c.currentTarget.style.backgroundColor="#0056b3",onMouseOut:c=>c.currentTarget.style.backgroundColor="#007bff",children:"Guardar Cambios"})]},i.id))})]})};export{kt as default};
