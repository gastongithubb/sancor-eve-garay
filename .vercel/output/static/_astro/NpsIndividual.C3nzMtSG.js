const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/index.B-abBoe3.js","_astro/index.RYns6xqu.js"])))=>i.map(i=>d[i]);
import{j as t}from"./jsx-runtime.PRPpl5vZ.js";import{r as h}from"./index.RYns6xqu.js";const w="modulepreload",j=function(n){return"/"+n},g={},v=function(o,c,y){let i=Promise.resolve();if(c&&c.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),a=l?.nonce||l?.getAttribute("nonce");i=Promise.all(c.map(e=>{if(e=j(e),e in g)return;g[e]=!0;const r=e.endsWith(".css"),p=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${p}`))return;const s=document.createElement("link");if(s.rel=r?"stylesheet":w,r||(s.as="script",s.crossOrigin=""),s.href=e,a&&s.setAttribute("nonce",a),document.head.appendChild(s),r)return new Promise((d,u)=>{s.addEventListener("load",d),s.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${e}`)))})}))}return i.then(()=>o()).catch(l=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l})};let m;async function f(){if(!m){const{Client:n}=await v(async()=>{const{Client:o}=await import("./index.B-abBoe3.js").then(c=>c.i);return{Client:o}},__vite__mapDeps([0,1]));m=new n({connectionString:{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:void 0,ASSETS_PREFIX:void 0}.POSTGRES_URL,ssl:{rejectUnauthorized:!1}})}return m}async function x(){try{await(await f()).connect(),console.log("Conectado a PostgreSQL")}catch(n){console.error("Error de conexión a PostgreSQL:",n)}}async function E(){try{await(await f()).end(),console.log("Desconectado de PostgreSQL")}catch(n){console.error("Error al desconectar de PostgreSQL:",n)}}async function b(n,o){return(await f()).query(n,o)}const P=()=>{const[n,o]=h.useState([]),[c,y]=h.useState(!0),[i,l]=h.useState(null);h.useEffect(()=>{async function e(){try{await x();const r=await b("SELECT * FROM metrics");o(r.rows)}catch(r){console.error("Error fetching metrics:",r),l("Error al cargar las métricas. Por favor, intenta de nuevo más tarde.")}finally{await E(),y(!1)}}e()},[]);const a=async(e,r,p)=>{const s=parseFloat(p);try{await x(),await b(`UPDATE metrics SET ${r} = $1 WHERE id = $2`,[s,e]),o(d=>d.map(u=>u.id===e?{...u,[r]:s}:u))}catch(d){console.error("Error updating metric:",d),l("Error al actualizar la métrica. Por favor, intenta de nuevo.")}finally{await E()}};return c?t.jsx("div",{children:"Cargando..."}):i?t.jsx("div",{className:"text-red-500",children:i}):t.jsxs("div",{className:"p-6 text-black bg-gray-100 rounded-lg shadow-lg",children:[t.jsx("h1",{className:"mb-6 text-3xl font-bold",children:"Métricas Individuales"}),t.jsxs("table",{className:"w-full text-left border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b-2 border-gray-300",children:[t.jsx("th",{className:"py-2",children:"Nombre"}),t.jsx("th",{className:"py-2",children:"Q de respuestas"}),t.jsx("th",{className:"py-2",children:"NPS"}),t.jsx("th",{className:"py-2",children:"CSAT"}),t.jsx("th",{className:"py-2",children:"RD"})]})}),t.jsx("tbody",{children:n.map(e=>t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("td",{className:"py-2",children:e.name}),t.jsx("td",{className:"py-2",children:t.jsx("input",{type:"number",value:e.responses,onChange:r=>a(e.id,"responses",r.target.value),className:"w-full p-1 text-black bg-gray-200 rounded"})}),t.jsx("td",{className:"py-2",children:t.jsx("input",{type:"number",value:e.nps,onChange:r=>a(e.id,"nps",r.target.value),className:"w-full p-1 text-black bg-gray-200 rounded"})}),t.jsx("td",{className:"py-2",children:t.jsx("input",{type:"number",value:e.csat,onChange:r=>a(e.id,"csat",r.target.value),className:"w-full p-1 text-black bg-gray-200 rounded"})}),t.jsx("td",{className:"py-2",children:t.jsx("input",{type:"number",value:e.rd,onChange:r=>a(e.id,"rd",r.target.value),className:"w-full p-1 text-black bg-gray-200 rounded"})})]},e.id))})]})]})};export{P as default};
