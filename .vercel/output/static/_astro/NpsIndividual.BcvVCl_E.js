import{j as s}from"./jsx-runtime.CYYqVSlZ.js";import{R as y,r as E}from"./index.DJO9vBfz.js";import{c as q,d as J}from"./db-users.Dr3UWatM.js";import{o as Q,p as Z,q as tt,r as p,s as et,t as rt,i as G,w as D,v as H,x as K,y as M,z as U,a as it,l as at,B as k,X as V,Y as R,m as nt,R as lt,T as ot,n as st,F as T}from"./generateCategoricalChart.BpvrHaXR.js";var ct=["x1","y1","x2","y2","key"],ht=["offset"];function w(t){"@babel/helpers - typeof";return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(t)}function W(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,r)}return a}function x(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?W(Object(a),!0).forEach(function(r){dt(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):W(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function dt(t,e,a){return e=ut(e),e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function ut(t){var e=ft(t,"string");return w(e)=="symbol"?e:String(e)}function ft(t,e){if(w(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,e||"default");if(w(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j(){return j=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},j.apply(this,arguments)}function L(t,e){if(t==null)return{};var a=vt(t,e),r,n;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)r=l[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vt(t,e){if(t==null)return{};var a={},r=Object.keys(t),n,l;for(l=0;l<r.length;l++)n=r[l],!(e.indexOf(n)>=0)&&(a[n]=t[n]);return a}var yt=function(e){var a=e.fill;if(!a||a==="none")return null;var r=e.fillOpacity,n=e.x,l=e.y,h=e.width,f=e.height;return y.createElement("rect",{x:n,y:l,width:h,height:f,stroke:"none",fill:a,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function X(t,e){var a;if(y.isValidElement(t))a=y.cloneElement(t,e);else if(G(t))a=t(e);else{var r=e.x1,n=e.y1,l=e.x2,h=e.y2,f=e.key,v=L(e,ct),u=it(v,!1);u.offset;var o=L(u,ht);a=y.createElement("line",j({},o,{x1:r,y1:n,x2:l,y2:h,fill:"none",key:f}))}return a}function xt(t){var e=t.x,a=t.width,r=t.horizontal,n=r===void 0?!0:r,l=t.horizontalPoints;if(!n||!l||!l.length)return null;var h=l.map(function(f,v){var u=x(x({},t),{},{x1:e,y1:f,x2:e+a,y2:f,key:"line-".concat(v),index:v});return X(n,u)});return y.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function gt(t){var e=t.y,a=t.height,r=t.vertical,n=r===void 0?!0:r,l=t.verticalPoints;if(!n||!l||!l.length)return null;var h=l.map(function(f,v){var u=x(x({},t),{},{x1:f,y1:e,x2:f,y2:e+a,key:"line-".concat(v),index:v});return X(n,u)});return y.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function mt(t){var e=t.horizontalFill,a=t.fillOpacity,r=t.x,n=t.y,l=t.width,h=t.height,f=t.horizontalPoints,v=t.horizontal,u=v===void 0?!0:v;if(!u||!e||!e.length)return null;var o=f.map(function(d){return Math.round(d+n-n)}).sort(function(d,i){return d-i});n!==o[0]&&o.unshift(0);var m=o.map(function(d,i){var c=!o[i+1],b=c?n+h-d:o[i+1]-d;if(b<=0)return null;var g=i%e.length;return y.createElement("rect",{key:"react-".concat(i),y:d,x:r,height:b,width:l,stroke:"none",fill:e[g],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return y.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},m)}function bt(t){var e=t.vertical,a=e===void 0?!0:e,r=t.verticalFill,n=t.fillOpacity,l=t.x,h=t.y,f=t.width,v=t.height,u=t.verticalPoints;if(!a||!r||!r.length)return null;var o=u.map(function(d){return Math.round(d+l-l)}).sort(function(d,i){return d-i});l!==o[0]&&o.unshift(0);var m=o.map(function(d,i){var c=!o[i+1],b=c?l+f-d:o[i+1]-d;if(b<=0)return null;var g=i%r.length;return y.createElement("rect",{key:"react-".concat(i),x:d,y:h,width:b,height:v,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return y.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},m)}var pt=function(e,a){var r=e.xAxis,n=e.width,l=e.height,h=e.offset;return H(K(x(x(x({},U.defaultProps),r),{},{ticks:M(r,!0),viewBox:{x:0,y:0,width:n,height:l}})),h.left,h.left+h.width,a)},jt=function(e,a){var r=e.yAxis,n=e.width,l=e.height,h=e.offset;return H(K(x(x(x({},U.defaultProps),r),{},{ticks:M(r,!0),viewBox:{x:0,y:0,width:n,height:l}})),h.top,h.top+h.height,a)},O={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Y(t){var e,a,r,n,l,h,f=Q(),v=Z(),u=tt(),o=x(x({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:O.stroke,fill:(a=t.fill)!==null&&a!==void 0?a:O.fill,horizontal:(r=t.horizontal)!==null&&r!==void 0?r:O.horizontal,horizontalFill:(n=t.horizontalFill)!==null&&n!==void 0?n:O.horizontalFill,vertical:(l=t.vertical)!==null&&l!==void 0?l:O.vertical,verticalFill:(h=t.verticalFill)!==null&&h!==void 0?h:O.verticalFill,x:p(t.x)?t.x:u.left,y:p(t.y)?t.y:u.top,width:p(t.width)?t.width:u.width,height:p(t.height)?t.height:u.height}),m=o.x,d=o.y,i=o.width,c=o.height,b=o.syncWithTicks,g=o.horizontalValues,N=o.verticalValues,P=et(),C=rt();if(!p(i)||i<=0||!p(c)||c<=0||!p(m)||m!==+m||!p(d)||d!==+d)return null;var $=o.verticalCoordinatesGenerator||pt,B=o.horizontalCoordinatesGenerator||jt,z=o.horizontalPoints,A=o.verticalPoints;if((!z||!z.length)&&G(B)){var I=g&&g.length,S=B({yAxis:C?x(x({},C),{},{ticks:I?g:C.ticks}):void 0,width:f,height:v,offset:u},I?!0:b);D(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(w(S),"]")),Array.isArray(S)&&(z=S)}if((!A||!A.length)&&G($)){var _=N&&N.length,F=$({xAxis:P?x(x({},P),{},{ticks:_?N:P.ticks}):void 0,width:f,height:v,offset:u},_?!0:b);D(Array.isArray(F),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(w(F),"]")),Array.isArray(F)&&(A=F)}return y.createElement("g",{className:"recharts-cartesian-grid"},y.createElement(yt,{fill:o.fill,fillOpacity:o.fillOpacity,x:o.x,y:o.y,width:o.width,height:o.height}),y.createElement(xt,j({},o,{offset:u,horizontalPoints:z,xAxis:P,yAxis:C})),y.createElement(gt,j({},o,{offset:u,verticalPoints:A,xAxis:P,yAxis:C})),y.createElement(mt,j({},o,{horizontalPoints:z})),y.createElement(bt,j({},o,{verticalPoints:A})))}Y.displayName="CartesianGrid";var wt=at({chartName:"BarChart",GraphicalChild:k,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:V},{axisType:"yAxis",AxisComp:R}],formatAxisMap:nt});const At=()=>{const[t,e]=E.useState([]),[a,r]=E.useState(!0),[n,l]=E.useState(null),[h,f]=E.useState("");E.useEffect(()=>{(async()=>{try{r(!0);const c=await q();e(c),l(null)}catch(c){console.error("Error al cargar usuarios:",c),l(`Error al cargar las métricas: ${c instanceof Error?c.message:String(c)}`)}finally{r(!1)}})()},[]);const v=async i=>{try{await J(i),e(t.map(c=>c.id===i.id?i:c))}catch(c){console.error("Error al actualizar el usuario:",c),l(`Error al actualizar el usuario: ${c instanceof Error?c.message:String(c)}`)}},u=(i,c,b)=>{e(t.map(g=>g.id===i?{...g,[c]:Number(b)}:g))},o=i=>i>=15?"#28a745":i>=0?"#ffc107":"#dc3545",m=i=>i>70?"#28a745":i>=65?"#ffc107":"#dc3545",d=t.filter(i=>i.name.toLowerCase().includes(h.toLowerCase()));return a?s.jsx("div",{children:"Cargando datos de usuarios..."}):n?s.jsxs("div",{children:["Error: ",n]}):t.length===0?s.jsx("div",{children:"No se encontraron datos de usuarios."}):s.jsxs("div",{children:[s.jsx("h1",{children:"Métricas - NPS Individual"}),s.jsx("input",{type:"text",placeholder:"Buscar por nombre...",value:h,onChange:i=>f(i.target.value),style:{marginBottom:"20px",padding:"5px",width:"200px"}}),s.jsx(lt,{width:"100%",height:500,children:s.jsxs(wt,{data:d,margin:{top:20,right:30,left:20,bottom:5},children:[s.jsx(Y,{strokeDasharray:"3 3"}),s.jsx(V,{dataKey:"name"}),s.jsx(R,{}),s.jsx(ot,{}),s.jsx(st,{}),s.jsx(k,{dataKey:"responses",fill:"#8884d8",name:"Encuestas"}),s.jsx(k,{dataKey:"nps",name:"NPS",children:d.map(i=>s.jsx(T,{fill:o(i.nps)},`cell-nps-${i.id}`))}),s.jsx(k,{dataKey:"csat",name:"CSAT",children:d.map(i=>s.jsx(T,{fill:m(i.csat)},`cell-csat-${i.id}`))}),s.jsx(k,{dataKey:"rd",name:"RD",children:d.map(i=>s.jsx(T,{fill:m(i.rd)},`cell-rd-${i.id}`))})]})}),s.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"20px"},children:d.map(i=>s.jsxs("div",{style:{border:"1px solid #ddd",padding:"15px",borderRadius:"8px",width:"300px"},children:[s.jsx("h2",{children:i.name}),s.jsx("div",{style:{marginBottom:"10px"},children:s.jsxs("label",{children:["Encuestas:",s.jsx("input",{type:"number",value:i.responses,onChange:c=>u(i.id,"responses",c.target.value),style:{width:"100%"}})]})}),s.jsx("div",{style:{marginBottom:"10px"},children:s.jsxs("label",{children:["NPS:",s.jsx("input",{type:"number",value:i.nps,onChange:c=>u(i.id,"nps",c.target.value),style:{width:"100%"}})]})}),s.jsx("div",{style:{marginBottom:"10px"},children:s.jsxs("label",{children:["CSAT:",s.jsx("input",{type:"number",value:i.csat,onChange:c=>u(i.id,"csat",c.target.value),style:{width:"100%"}})]})}),s.jsx("div",{style:{marginBottom:"10px"},children:s.jsxs("label",{children:["RD:",s.jsx("input",{type:"number",value:i.rd,onChange:c=>u(i.id,"rd",c.target.value),style:{width:"100%"}})]})}),s.jsx("button",{onClick:()=>v(i),style:{width:"100%",padding:"10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",transition:"background-color 0.3s"},onMouseOver:c=>c.currentTarget.style.backgroundColor="#0056b3",onMouseOut:c=>c.currentTarget.style.backgroundColor="#007bff",children:"Guardar Cambios"})]},i.id))})]})};export{At as default};
