import{j as e}from"./jsx-runtime.CYYqVSlZ.js";import{r as n}from"./index.DJO9vBfz.js";import{g as O,a as X,u as G,b as U}from"./db-users.Dr3UWatM.js";const u=(...s)=>s.filter(Boolean).join(" "),v=n.forwardRef(({className:s,...t},o)=>e.jsx("table",{ref:o,className:u("w-full caption-bottom text-sm",s),...t}));v.displayName="Table";const E=n.forwardRef(({className:s,...t},o)=>e.jsx("thead",{ref:o,className:u("[&_tr]:border-b",s),...t}));E.displayName="TableHeader";const T=n.forwardRef(({className:s,...t},o)=>e.jsx("tbody",{ref:o,className:u("[&_tr:last-child]:border-0",s),...t}));T.displayName="TableBody";const W=n.forwardRef(({className:s,...t},o)=>e.jsx("tfoot",{ref:o,className:u("bg-primary font-medium text-primary-foreground",s),...t}));W.displayName="TableFooter";const N=n.forwardRef(({className:s,...t},o)=>e.jsx("tr",{ref:o,className:u("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));N.displayName="TableRow";const c=n.forwardRef(({className:s,...t},o)=>e.jsx("th",{ref:o,className:u("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));c.displayName="TableHead";const m=n.forwardRef(({className:s,...t},o)=>e.jsx("td",{ref:o,className:u("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));m.displayName="TableCell";const Y=n.forwardRef(({className:s,...t},o)=>e.jsx("caption",{ref:o,className:u("mt-4 text-sm text-muted-foreground",s),...t}));Y.displayName="TableCaption";/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),I=(...s)=>s.filter((t,o,h)=>!!t&&h.indexOf(t)===o).join(" ");/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var J={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=n.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:o=2,absoluteStrokeWidth:h,className:g="",children:x,iconNode:w,...k},f)=>n.createElement("svg",{ref:f,...J,width:t,height:t,stroke:s,strokeWidth:h?Number(o)*24/Number(t):o,className:I("lucide",g),...k},[...w.map(([C,b])=>n.createElement(C,b)),...Array.isArray(x)?x:[x]]));/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=(s,t)=>{const o=n.forwardRef(({className:h,...g},x)=>n.createElement(K,{ref:x,iconNode:t,className:I(`lucide-${_(s)}`,h),...g}));return o.displayName=`${s}`,o};/**
 * @license lucide-react v0.403.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=P("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Z=["Lunes","Martes","Miércoles","Jueves","Viernes"],j=new Date().getFullYear(),y=new Date().getMonth()+1,ee=()=>{const[s,t]=n.useState([]),[o,h]=n.useState({}),[g,x]=n.useState(!0),[w,k]=n.useState(null),[f,C]=n.useState({}),[b,S]=n.useState([]),[L,R]=n.useState("");n.useEffect(()=>{(async()=>{try{x(!0);const r=await O();t(r);const l={};for(const i of r)l[i.id]=await X(i.id,y,j);h(l)}catch(r){console.error("Error fetching data:",r),k(`Error al cargar los datos: ${r instanceof Error?r.message:String(r)}`)}finally{x(!1)}})()},[]);const $=(a,r)=>{C(l=>({...l,[a]:r}))},B=(a,r,l,i,d)=>{const M={employeeId:a,day:r,week:l,month:y,year:j,startTime:i,endTime:d};S(F=>[...F.filter(p=>p.employeeId!==a||p.day!==r||p.week!==l||p.month!==y||p.year!==j),M])},D=async()=>{try{for(const[a,r]of Object.entries(f))await G(Number(a),r);t(s.map(a=>f[a.id]?{...a,xLite:f[a.id]}:a)),C({}),alert("Cambios en empleados guardados exitosamente")}catch(a){console.error("Error saving employee changes:",a),alert(`Error al guardar los cambios en empleados: ${a instanceof Error?a.message:String(a)}`)}},H=async()=>{try{for(const r of b)console.log("Intentando guardar horario:",r),await U(r),console.log("Horario guardado exitosamente:",r);const a={...o};for(const r of b){a[r.employeeId]||(a[r.employeeId]=[]);const l=a[r.employeeId].findIndex(i=>i.day===r.day&&i.week===r.week&&i.month===r.month&&i.year===r.year);l!==-1?a[r.employeeId][l]={id:a[r.employeeId][l].id,...r}:a[r.employeeId].push({id:0,...r})}h(a),S([]),alert("Cambios en horarios de break guardados exitosamente")}catch(a){console.error("Error detallado al guardar cambios de break:",a),alert(`Error al guardar los cambios en horarios de break: ${a instanceof Error?a.message:String(a)}`)}},A=s.filter(a=>`${a.firstName} ${a.lastName}`.toLowerCase().includes(L.toLowerCase()));return g?e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[e.jsx(V,{className:"w-12 h-12 text-blue-500 animate-spin"}),e.jsx("p",{className:"mt-4 text-lg font-semibold text-gray-700",children:"Cargando programacion semanal."})]}):w?e.jsx("div",{className:"flex flex-col items-center justify-center h-screen",children:e.jsx("p",{className:"text-lg font-semibold text-red-600",children:w})}):e.jsxs("div",{className:"container p-4 mx-auto",children:[e.jsx("h2",{className:"mb-4 text-2xl font-bold",children:"Programacion Semanal"}),s.length===0?e.jsx("p",{children:"No hay empleados para mostrar."}):e.jsxs(e.Fragment,{children:[e.jsxs(v,{children:[e.jsx(E,{children:e.jsxs(N,{children:[e.jsx(c,{children:"Apellido y Nombre"}),e.jsx(c,{children:"Email"}),e.jsx(c,{children:"DNI"}),e.jsx(c,{children:"Ingreso"}),e.jsx(c,{children:"Egreso"}),e.jsx(c,{children:"Hs. Trabajo"}),e.jsx(c,{children:"X LITE"})]})}),e.jsx(T,{children:s.map(a=>e.jsxs(N,{children:[e.jsxs(m,{children:[a.lastName," ",a.firstName]}),e.jsx(m,{children:a.email}),e.jsx(m,{children:a.dni}),e.jsx(m,{children:a.entryTime}),e.jsx(m,{children:a.exitTime}),e.jsx(m,{children:a.hoursWorked}),e.jsx(m,{children:e.jsx("input",{type:"text",value:f[a.id]||a.xLite||"",onChange:r=>$(a.id,r.target.value),className:"px-2 py-1 border rounded"})})]},a.id))})]}),e.jsx("button",{onClick:D,className:"px-4 py-2 mt-4 font-bold text-white rounded bg-[#000] hover:bg-black",disabled:Object.keys(f).length===0,children:"Guardar Cambios en Empleados"})]}),e.jsx("h3",{className:"mt-8 mb-4 text-xl font-bold",children:"Horarios de Break"}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Buscar empleado...",value:L,onChange:a=>R(a.target.value),className:"w-full px-2 py-1 border rounded"})}),A.map(a=>e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"mb-2 text-lg font-semibold",children:[a.firstName," ",a.lastName]}),e.jsxs(v,{children:[e.jsx(E,{children:e.jsxs(N,{children:[e.jsx(c,{children:"Día"}),e.jsx(c,{children:"Semana 1"}),e.jsx(c,{children:"Semana 2"}),e.jsx(c,{children:"Semana 3"}),e.jsx(c,{children:"Semana 4"}),e.jsx(c,{children:"Semana 5"})]})}),e.jsx(T,{children:Z.map(r=>e.jsxs(N,{children:[e.jsx(m,{children:r}),[1,2,3,4,5].map(l=>{const i=b.find(d=>d.employeeId===a.id&&d.day===r&&d.week===l&&d.month===y&&d.year===j)||o[a.id]?.find(d=>d.day===r&&d.week===l&&d.month===y&&d.year===j)||{startTime:"",endTime:""};return e.jsxs(m,{children:[e.jsx("input",{type:"time",value:i.startTime,onChange:d=>B(a.id,r,l,d.target.value,i.endTime),className:"px-2 py-1 mr-2 border rounded"}),e.jsx("input",{type:"time",value:i.endTime,onChange:d=>B(a.id,r,l,i.startTime,d.target.value),className:"px-2 py-1 border rounded"})]},l)})]},r))})]})]},a.id)),e.jsx("button",{onClick:H,className:"px-4 py-2 mt-4 font-bold text-white rounded bg-[#000] hover:bg-black",disabled:b.length===0,children:"Guardar Cambios en Horarios de Break"})]})};export{ee as default};
