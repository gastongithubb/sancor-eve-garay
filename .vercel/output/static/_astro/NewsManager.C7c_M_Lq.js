import{j as r}from"./jsx-runtime.CYYqVSlZ.js";import{r as l}from"./index.DJO9vBfz.js";import{c as z,d as C,s as D,i as S,t as f,a as w,b as N}from"./config.Dew_jzzj.js";const q=z({url:w.tursoConnectionUrl,authToken:w.tursoAuthToken}),h=C(q),m=D("news",{id:S("id").primaryKey(),url:f("url").notNull(),title:f("title").notNull(),publishDate:f("publish_date").notNull()});async function T(){try{return await h.select().from(m).all()}catch(o){throw console.error("Error al obtener noticias:",o),o}}async function L(o){try{await h.insert(m).values(o).run()}catch(n){throw console.error("Error al añadir noticia:",n),n}}async function P(o){try{await h.delete(m).where(N`id = ${o}`).run()}catch(n){throw console.error("Error al eliminar noticia:",n),n}}async function A(o,n){try{await h.update(m).set(n).where(N`id = ${o}`).run()}catch(u){throw console.error("Error al actualizar noticia:",u),u}}const B=()=>{const[o,n]=l.useState([]),[u,v]=l.useState([]),[p,j]=l.useState(""),[s,d]=l.useState({url:"",title:"",publishDate:""}),[a,i]=l.useState(null),[x,c]=l.useState(null);l.useEffect(()=>{b()},[]),l.useEffect(()=>{const e=o.filter(t=>t.title.toLowerCase().includes(p.toLowerCase()));v(e)},[p,o]);const b=async()=>{try{const e=await T();n(e)}catch(e){console.error("Error fetching news:",e),c("Error al cargar las noticias. Por favor, intenta de nuevo.")}},g=e=>!e.url.trim()||!e.title.trim()||!e.publishDate.trim()?(c("Todos los campos son obligatorios."),!1):(c(null),!0),y=async e=>{if(e.preventDefault(),!!g(s))try{await L(s),b(),d({url:"",title:"",publishDate:""})}catch(t){console.error("Error adding news:",t),c("Error al añadir la noticia. Por favor, intenta de nuevo.")}},E=async e=>{try{await P(e),b()}catch(t){console.error("Error deleting news:",t),c("Error al eliminar la noticia. Por favor, intenta de nuevo.")}},k=async e=>{if(e.preventDefault(),a&&g(a))try{await A(a.id,a),b(),i(null)}catch(t){console.error("Error updating news:",t),c("Error al actualizar la noticia. Por favor, intenta de nuevo.")}};return r.jsxs("div",{className:"container p-4 mx-auto font-SpaceGrotesk",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-black",children:"Gestor de Noticias"}),r.jsxs("div",{className:"relative w-64",children:[r.jsx("input",{type:"text",placeholder:"Buscar por título",value:p,onChange:e=>j(e.target.value),className:"w-full p-2 pl-10 pr-4 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime"}),r.jsx("svg",{className:"absolute w-5 h-5 transform -translate-y-1/2 left-3 top-1/2 text-zinc-400",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),x&&r.jsx("div",{className:"p-2 mb-4 text-red-700 bg-red-100 rounded-lg",children:x}),r.jsxs("form",{onSubmit:y,className:"mb-4",children:[r.jsx("input",{type:"text",placeholder:"URL",value:s.url,onChange:e=>d({...s,url:e.target.value}),className:"p-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),r.jsx("input",{type:"text",placeholder:"Título",value:s.title,onChange:e=>d({...s,title:e.target.value}),className:"p-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),r.jsx("input",{type:"date",value:s.publishDate,onChange:e=>d({...s,publishDate:e.target.value}),className:"p-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),r.jsx("button",{type:"submit",className:"p-2 text-white transition duration-300 bg-black rounded-lg hover:bg-lime",children:"Añadir Noticia"})]}),r.jsx("div",{className:"space-y-4",children:u.map(e=>r.jsx("div",{className:"p-4 bg-white border rounded-lg shadow-card border-zinc-300",children:a&&a.id===e.id?r.jsxs("form",{onSubmit:k,children:[r.jsx("input",{type:"text",value:a.url,onChange:t=>i({...a,url:t.target.value}),className:"p-2 mb-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),r.jsx("input",{type:"text",value:a.title,onChange:t=>i({...a,title:t.target.value}),className:"p-2 mb-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),r.jsx("input",{type:"date",value:a.publishDate,onChange:t=>i({...a,publishDate:t.target.value}),className:"p-2 mb-2 mr-2 border rounded-lg border-zinc-300 focus:outline-none focus:border-lime",required:!0}),r.jsx("button",{type:"submit",className:"p-2 mr-2 text-white transition duration-300 bg-black rounded-lg hover:bg-lime",children:"Guardar"}),r.jsx("button",{onClick:()=>i(null),className:"p-2 text-black transition duration-300 rounded-lg bg-zinc-200 hover:bg-zinc-300",children:"Cancelar"})]}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"mb-2 text-xl font-bold text-black",children:e.title}),r.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"mb-2 transition duration-300 text-lime hover:text-black",children:e.url}),r.jsx("p",{className:"mb-4 text-zinc-500",children:e.publishDate}),r.jsx("button",{onClick:()=>i(e),className:"p-2 mr-2 text-black transition duration-300 rounded-lg bg-zinc-200 hover:bg-zinc-300",children:"Editar"}),r.jsx("button",{onClick:()=>E(e.id),className:"p-2 text-white transition duration-300 bg-black rounded-lg hover:bg-lime",children:"Eliminar"})]})},e.id))})]})};export{B as default};
